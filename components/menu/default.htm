{# Note: Only one levels of sublinks are supported by Bootstrap 3 #}
{# This is usually added in a navbar ul, eg: <ul class="nav navbar-nav navbar-right"> #}
{% macro render_menu(links) %}
    {% for code, link in links %}
        <li class=" {{ link.sublinks ? 'dropdown' }} {{ code == currentPage ? 'active' }}">
            <a href="{{ link.children ? '#' : (link.page)|page }}"
               {% if link.children %}data-toggle="dropdown"{% endif %}
               class="{{ link.children ? 'dropdown-toggle' }}"
                    >
                {% if link.getAttributes().icon %}
                    <i class="fa {{ link.getAttributes().icon ? link.getAttributes().icon :
                    (menu.getAttributes().default_icon ? menu.getAttributes().default_icon) }}"></i>
                {% endif %}
                <span>{{ link.getAttributes().label }}</span>
                {% if link.children %}<span class="caret"></span>{% endif %}
            </a>
            {% if link.children %}
                <ul class="dropdown-menu">
                    {{ _self.render_menu(link.children) }}
                </ul>
            {% endif %}
        </li>
    {% endfor %}
{% endmacro %}

{# If your adding this directly to your page/layout/paritial, change the __SELF__ to your component alias (eg. menu.menuTree) #}
{% set menuTree = __SELF__.menuTree %}

{{ _self.render_menu(menuTree) }} {# this actually prints the menu #}

